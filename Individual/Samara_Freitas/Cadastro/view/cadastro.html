<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Configuração de Usuários</title>
    <link rel="stylesheet" href="../style/cadastro.css" />
    <link rel="stylesheet" href="../style/global.css" />
    <link rel="stylesheet" href="../style/navbar.css" />
    <link rel="stylesheet" href="../style/footer.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
  </head>

  <body>
    <!-- Inicio da Navbar -->

    <header class="navbar">
      <div class="container_nav"> 
        <div id="logo_nav">
          <a href=""><img src="../asset/img/Logo.svg" alt="" /></a>
        </div>

        <nav class="nav">
          <ul class="ul_nav">
            <li><a href="">Landing Page</a></li>
            <li><a href="">Dashboard</a></li>
            <li><a href="">Calculadora</a></li>
            <li><a href="">Contato</a></li>
            <li><a id="page_atual" href="">Configurações</a></li>
          </ul>

          <div class="user">
            <a href=""><img src="../asset/img/Avatar.svg" alt="" /></a>
            <span id="msg_user"></span>
          </div>
        </nav>
      </div>
    </header>

    <!-- Fim da Navbar -->

    <!-- Conteúdo Principal -->
    <main class="container">
      <div class="card">
        <h2>Configuração de Usuários</h2>

        <div class="acoes">
          <button class="btn btn-novo" onclick="novoUsuario()">
            + Novo Usuário
          </button>

          <div class="dropdown">
            <button class="btn btn-filtro" onclick="toggleFiltro()">
              <img src="../assets/Vector.png" alt="Filtro" class="icon" />
              Filtros
              <img
                src="../assets/filtro.png"
                alt="filtro_triangulo"
                class="icontriangulo"
              />
            </button>

            <div id="menuFiltro" class="menu-filtro">
              <button onclick="filtrarUsuarios('todos')">Todos</button>
              <button onclick="filtrarUsuarios('Administrador')">
                Administrador
              </button>
              <button onclick="filtrarUsuarios('Padrão')">Padrão</button>
            </div>
          </div>

          <button class="btn btn-editar" onclick="editarUsuario()">
            <img src="../assets/editar.png" alt="Editar" class="icon" />
            Editar
          </button>
        </div>

        <table id="tabelaUsuarios">
          <thead>
            <tr>
              <!-- checkbox para marcar/desmarcar todos -->
              <th>
                <input
                  type="checkbox"
                  id="checkAll"
                  onclick="selecionarTodos()"
                />
              </th>
              <th>Usuário</th>
              <th>E-mail</th>
              <th>Nível Acesso</th>
            </tr>
          </thead>
          <tbody>
            <!-- Linhas adicionadas via JS -->
          </tbody>
        </table>
      </div>
    </main>

    <!-- Inicio da Footer -->

    <div class="footer">
      <div class="container_footer">
        <div class="ftr_slogan">
          <img src="../asset/img/Logo_branca.svg" alt="" />

          <p id="slogan">
            Transformando a gestão de resíduos urbanos através da <br />
            tecnologia e inovação
          </p>
        </div>

        <div class="ftr_links">
          <ul>
            <h4 class="title">Links Rápidos</h4>
            <li><a href=""></a>Inicio</li>
            <li><a href=""></a>Sobre</li>
            <li><a href=""></a>Quem Somos</li>
            <li><a href=""></a>Serviços</li>
            <li><a href=""></a>Contato</li>
            <li><a href=""></a>Entrar</li>
          </ul>
        </div>

        <div class="ftr_contatos">
          <ul>
            <h4 class="title">Contatos</h4>
            <li>
              <img src="../asset/img/IconEmail.png" alt="" />
              contato@retech.com
            </li>
            <li>
              <img src="../asset/img/IconPhone.png" alt="" />
              (11) 99999-9999
            </li>
            <li>
              <img src="../asset/img/IconPlaceMarker.png" alt="" />
              São Paulo - SP
            </li>
          </ul>
        </div>
      </div>

      <hr />

      <p id="direitos">&copy; 2025 ReTech. Todos os direitos reservados.</p>
    </div>

    <!-- Final da Footer -->
  </body>
</html>

<script>
  var tabela = document.querySelector("#tabelaUsuarios tbody");
  var usuarios = [
    {
      nome: "Claudio Frizzarini",
      email: "Claudio@prefeituraSP.com",
      nivel: "Administrador",
    },
    {
      nome: "Julia Araripe",
      email: "Julia@prefeituraCampinas.com",
      nivel: "Padrão",
    },
  ];
  var filtroAtual = "todos";

  function carregarUsuarios() {
    tabela.innerHTML = "";
    var usuariosFiltrados = usuarios.filter(function (u) {
      if (filtroAtual === "todos") {
        return true;
      } else {
        return u.nivel === filtroAtual;
      }
    });

    for (var i = 0; i < usuariosFiltrados.length; i++) {
      var u = usuariosFiltrados[i];
      var originalIndex = usuarios.indexOf(u);
      tabela.innerHTML += `
            <tr>
              <td><input type="checkbox" class="checkUsuario" data-id="${originalIndex}"></td>
              <td>${u.nome}</td>
              <td>${u.email}</td>
              <td>${u.nivel}</td>
            </tr>
          `;
    }
  }

  function selecionarTodos() {
    var checkAll = document.querySelector("#checkAll");
    var checks = document.querySelectorAll(".checkUsuario");
    for (var i = 0; i < checks.length; i++) {
      checks[i].checked = checkAll.checked;
    }
  }

  function novoUsuario() {
    var nome = prompt("Digite o nome do novo usuário:");
    if (!nome) return alert("Operação cancelada: nome obrigatório.");
    var email = prompt("Digite o e-mail:");
    if (!email) return alert("Operação cancelada: e-mail obrigatório.");
    var nivel = prompt("Informe o nível de acesso (Administrador / Padrão):");
    if (!nivel) return alert("Operação cancelada: nível obrigatório.");
    usuarios.push({ nome, email, nivel });
    carregarUsuarios();
    alert("✅ Usuário cadastrado com sucesso!");
  }

  function editarUsuario() {
    var selecionados = document.querySelectorAll(".checkUsuario:checked");
    if (selecionados.length != 1) {
      alert("⚠️ Selecione exatamente 1 usuário para editar.");
      return;
    }
    var id = parseInt(selecionados[0].getAttribute("data-id"));
    var usuario = usuarios[id];
    var novoNome = prompt("Editar nome:", usuario.nome);
    var novoEmail = prompt("Editar e-mail:", usuario.email);
    var novoNivel = prompt("Editar nível de acesso:", usuario.nivel);
    if (!novoNome || !novoEmail || !novoNivel) {
      alert("⚠️ Edição cancelada — todos os campos são obrigatórios.");
      return;
    }
    usuarios[id].nome = novoNome;
    usuarios[id].email = novoEmail;
    usuarios[id].nivel = novoNivel;
    carregarUsuarios();
    alert("Dados do usuário atualizados com sucesso!");
  }

  function toggleFiltro() {
    var menu = document.getElementById("menuFiltro");
    menu.classList.toggle("mostrar");
  }

  function filtrarUsuarios(tipo) {
    filtroAtual = tipo;
    carregarUsuarios();
  }

  carregarUsuarios();
</script>
